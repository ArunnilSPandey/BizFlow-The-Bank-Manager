"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[383],{285:(e,t,r)=>{r.d(t,{$:()=>l});var a=r(5155),i=r(2115),n=r(4253),s=r(2085),o=r(9434);let u=(0,s.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),l=i.forwardRef((e,t)=>{let{className:r,variant:i,size:s,asChild:l=!1,...d}=e,c=l?n.DX:"button";return(0,a.jsx)(c,{className:(0,o.cn)(u({variant:i,size:s,className:r})),ref:t,...d})});l.displayName="Button"},610:(e,t,r)=>{r.d(t,{$:()=>i});var a=r(3004);class i extends Error{constructor(e){let t=function(e){let t=null;try{let e=(0,a.xI)().currentUser;e&&(t=function(e){var t;if(!e)return null;let r={name:e.displayName,email:e.email,email_verified:e.emailVerified,phone_number:e.phoneNumber,sub:e.uid,firebase:{identities:e.providerData.reduce((e,t)=>(t.providerId&&(e[t.providerId]=[t.uid]),e),{}),sign_in_provider:(null==(t=e.providerData[0])?void 0:t.providerId)||"custom",tenant:e.tenantId}};return{uid:e.uid,token:r}}(e))}catch(e){}return{auth:t,method:e.operation,path:"/databases/(default)/documents/".concat(e.path),resource:e.requestResourceData?{data:e.requestResourceData}:void 0}}(e);super("Missing or insufficient permissions: The following request was denied by Firestore Security Rules:\n".concat(JSON.stringify(t,null,2))),this.name="FirebaseError",this.request=t}}},2400:(e,t,r)=>{r.d(t,{ZJ:()=>u,R8:()=>l,As:()=>c,D3:()=>d,sh:()=>m,jt:()=>p,$e:()=>f,Jd:()=>h});var a=r(5155),i=r(2115),n=r(3004),s=r(3310);function o(){let[e,t]=(0,i.useState)(null);if((0,i.useEffect)(()=>{let e=e=>{t(e)};return s.d.on("permission-error",e),()=>{s.d.off("permission-error",e)}},[]),e)throw e;return null}let u=(0,i.createContext)(void 0),l=e=>{let{children:t,firebaseApp:r,firestore:s,auth:l}=e,[d,c]=(0,i.useState)({user:null,isUserLoading:!0,userError:null});(0,i.useEffect)(()=>{if(!l)return void c({user:null,isUserLoading:!1,userError:Error("Auth service not provided.")});c({user:null,isUserLoading:!0,userError:null});let e=(0,n.hg)(l,e=>{c({user:e,isUserLoading:!1,userError:null})},e=>{console.error("FirebaseProvider: onAuthStateChanged error:",e),c({user:null,isUserLoading:!1,userError:e})});return()=>e()},[l]);let p=(0,i.useMemo)(()=>{let e=!!(r&&s&&l);return{areServicesAvailable:e,firebaseApp:e?r:null,firestore:e?s:null,auth:e?l:null,user:d.user,isUserLoading:d.isUserLoading,userError:d.userError}},[r,s,l,d]);return(0,a.jsxs)(u.Provider,{value:p,children:[(0,a.jsx)(o,{}),t]})},d=()=>{let e=(0,i.useContext)(u);if(void 0===e)throw Error("useFirebase must be used within a FirebaseProvider.");if(!e.areServicesAvailable||!e.firebaseApp||!e.firestore||!e.auth)throw Error("Firebase core services not available. Check FirebaseProvider props.");return{firebaseApp:e.firebaseApp,firestore:e.firestore,auth:e.auth,user:e.user,isUserLoading:e.isUserLoading,userError:e.userError}},c=()=>{let{auth:e}=d();return e},p=()=>{let{firestore:e}=d();return e},m=()=>{let{firebaseApp:e}=d();return e};function f(e,t){let r=(0,i.useMemo)(e,t);return"object"!=typeof r||null===r||(r.__memo=!0),r}let h=()=>{let{user:e,isUserLoading:t,userError:r}=d();return{user:e,isUserLoading:t,userError:r}}},3310:(e,t,r)=>{r.d(t,{d:()=>a});let a=function(){let e={};return{on(t,r){var a;e[t]||(e[t]=[]),null==(a=e[t])||a.push(r)},off(t,r){var a;e[t]&&(e[t]=null==(a=e[t])?void 0:a.filter(e=>e!==r))},emit(t,r){var a;e[t]&&(null==(a=e[t])||a.forEach(e=>e(r)))}}}()},4659:(e,t,r)=>{r.d(t,{GameProvider:()=>c,I:()=>p});var a=r(5155),i=r(2115),n=r(5317),s=r(6671),o=r(610),u=r(3310);let l=(0,i.createContext)(void 0),d="bizflow_gameId";function c(e){let{children:t}=e,r=(0,s.useFirestore)(),{user:c,isUserLoading:p}=(0,s.useUser)(),[m,f]=(0,i.useState)(null),[h,g]=(0,i.useState)([]),[v,b]=(0,i.useState)([]),[S,y]=(0,i.useState)(null),[w,E]=(0,i.useState)(null),[A,D]=(0,i.useState)(null),[I,x]=(0,i.useState)(!0);(0,i.useEffect)(()=>{let e=localStorage.getItem(d);e&&E(e),x(!1)},[]),(0,i.useEffect)(()=>{if(!w||!c)return;x(!0);let e=(0,n.H9)(r,"games",w),t=(0,n.aQ)(e,e=>{e.exists()?(f({id:e.id,...e.data()}),D(null)):(D("Game not found."),C())},e=>{D("Could not subscribe to game data.")}),a=(0,n.rJ)(r,"games",w,"players"),i=(0,n.aQ)(a,e=>{g(e.docs.map(e=>({id:e.id,...e.data()})))}),s=(0,n.rJ)(r,"games",w,"transactions"),o=(0,n.aQ)(s,e=>{b(e.docs.map(e=>({id:e.id,...e.data()})))}),u=(0,n.H9)(r,"games",w,"userGameRoles",c.uid),l=(0,n.aQ)(u,e=>{e.exists()&&y(e.data())});return x(!1),()=>{t(),i(),o(),l()}},[w,c,r]);let _=()=>{let e="ABCDEFGHIJKLMNPQRSTUVWXYZ123456789",t="";for(let r=0;r<4;r++)t+=e.charAt(Math.floor(Math.random()*e.length));return"BIZ-".concat(t)},k=(0,i.useCallback)(async()=>{if(!c)return void D("You must be signed in to create a game.");x(!0),D(null);let e={gameCode:_(),initialCapital:15e3,gameStarted:!1,createdAt:new Date,passStartAmount:2e3,loanInterestRate:.1},t={userId:c.uid,role:"Banker",onlineStatus:!0,lastSeen:new Date};try{let a=await (0,n.gS)((0,n.rJ)(r,"games"),e),i=(0,n.H9)(r,"games",a.id,"userGameRoles",c.uid);await (0,n.BN)(i,t),localStorage.setItem(d,a.id),E(a.id)}catch(a){let r=new o.$({path:"games",operation:"create",requestResourceData:{game:e,role:t}});u.d.emit("permission-error",r),D("Failed to create game. Check permissions.")}finally{x(!1)}},[r,c]),T=(0,i.useCallback)(async e=>{if(!c)return void D("You must be signed in to join a game.");x(!0),D(null);let t=(0,n.P)((0,n.rJ)(r,"games"),(0,n._M)("gameCode","==",e));try{let e=await (0,n.GG)(t);if(e.empty){D("No game found with this code."),x(!1);return}let a=e.docs[0].id,i=(0,n.H9)(r,"games",a,"userGameRoles",c.uid),s={userId:c.uid,role:"Viewer",onlineStatus:!0,lastSeen:new Date};(0,n.BN)(i,s,{merge:!0}).catch(e=>{let t=new o.$({path:i.path,operation:"write",requestResourceData:s});u.d.emit("permission-error",t)}),localStorage.setItem(d,a),E(a)}catch(r){let t=new o.$({path:"games",operation:"list",requestResourceData:{gameCode:e}});u.d.emit("permission-error",t),D("Failed to join game.")}finally{x(!1)}},[r,c]),F=(0,i.useCallback)(async(e,t)=>{if(!w||!c||(null==S?void 0:S.role)!=="Banker")return void D("Only the Banker can start the game.")},[w,c,S]),C=()=>{localStorage.removeItem(d),E(null),f(null),g([]),b([]),y(null),D(null)},R=(0,i.useCallback)(async e=>{if(!w||(null==S?void 0:S.role)!=="Banker")return;let t=(0,n.H9)(r,"games",w);try{await (0,n.mZ)(t,e)}catch(a){let r=new o.$({path:t.path,operation:"update",requestResourceData:e});u.d.emit("permission-error",r)}},[w,S,r]);return(0,a.jsx)(l.Provider,{value:{game:m,players:h,transactions:v,userGameRole:S,gameId:w,error:A,loading:I||p,createGame:k,joinGame:T,startGame:F,exitGame:C,updateGameSettings:R},children:t})}function p(){let e=(0,i.useContext)(l);if(void 0===e)throw Error("useGame must be used within a GameProvider");return e}},6671:(e,t,r)=>{r.r(t),r.d(t,{FirebaseClientProvider:()=>d,FirebaseContext:()=>o.ZJ,FirebaseProvider:()=>o.R8,FirestorePermissionError:()=>p.$,addDocumentNonBlocking:()=>g,deleteDocumentNonBlocking:()=>b,errorEmitter:()=>c.d,getSdks:()=>A,initializeFirebase:()=>E,initiateAnonymousSignIn:()=>S,initiateEmailSignIn:()=>w,initiateEmailSignUp:()=>y,setDocumentNonBlocking:()=>h,updateDocumentNonBlocking:()=>v,useAuth:()=>o.As,useCollection:()=>m,useDoc:()=>f,useFirebase:()=>o.D3,useFirebaseApp:()=>o.sh,useFirestore:()=>o.jt,useMemoFirebase:()=>o.$e,useUser:()=>o.Jd});let a={projectId:"studio-6409199899-cb001",appId:"1:108170289927:web:8a8e8ea564080262b31ba2",apiKey:"AIzaSyCTio6VHtkSnx_QRq0-x0dcY8vpcD_1gvg",authDomain:"studio-6409199899-cb001.firebaseapp.com",measurementId:"",messagingSenderId:"108170289927"};var i=r(3915),n=r(3004),s=r(5317),o=r(2400),u=r(5155),l=r(2115);function d(e){let{children:t}=e,r=(0,l.useMemo)(()=>E(),[]);return(0,u.jsx)(o.R8,{firebaseApp:r.firebaseApp,auth:r.auth,firestore:r.firestore,children:t})}var c=r(3310),p=r(610);function m(e){let[t,r]=(0,l.useState)(null),[a,i]=(0,l.useState)(!1),[n,o]=(0,l.useState)(null);if((0,l.useEffect)(()=>{if(!e){r(null),i(!1),o(null);return}i(!0),o(null);let t=(0,s.aQ)(e,e=>{let t=[];for(let r of e.docs)t.push({...r.data(),id:r.id});r(t),o(null),i(!1)},t=>{let a="collection"===e.type?e.path:e._query.path.canonicalString(),n=new p.$({operation:"list",path:a});o(n),r(null),i(!1),c.d.emit("permission-error",n)});return()=>t()},[e]),e&&!e.__memo)throw Error(e+" was not properly memoized using useMemoFirebase");return{data:t,isLoading:a,error:n}}function f(e){let[t,r]=(0,l.useState)(null),[a,i]=(0,l.useState)(!1),[n,o]=(0,l.useState)(null);return(0,l.useEffect)(()=>{if(!e){r(null),i(!1),o(null);return}i(!0),o(null);let t=(0,s.aQ)(e,e=>{e.exists()?r({...e.data(),id:e.id}):r(null),o(null),i(!1)},t=>{let a=new p.$({operation:"get",path:e.path});o(a),r(null),i(!1),c.d.emit("permission-error",a)});return()=>t()},[e]),{data:t,isLoading:a,error:n}}function h(e,t,r){(0,s.BN)(e,t,r).catch(r=>{c.d.emit("permission-error",new p.$({path:e.path,operation:"write",requestResourceData:t}))})}function g(e,t){return(0,s.gS)(e,t).catch(r=>{c.d.emit("permission-error",new p.$({path:e.path,operation:"create",requestResourceData:t}))})}function v(e,t){(0,s.mZ)(e,t).catch(r=>{c.d.emit("permission-error",new p.$({path:e.path,operation:"update",requestResourceData:t}))})}function b(e){(0,s.kd)(e).catch(t=>{c.d.emit("permission-error",new p.$({path:e.path,operation:"delete"}))})}function S(e){(0,n.zK)(e)}function y(e,t,r){(0,n.eJ)(e,t,r)}function w(e,t,r){(0,n.x9)(e,t,r)}function E(){if(!(0,i.Dk)().length){let e;try{e=(0,i.Wp)()}catch(t){console.warn("Automatic initialization failed. Falling back to firebase config object.",t),e=(0,i.Wp)(a)}return A(e)}return A((0,i.Sx)())}function A(e){return{firebaseApp:e,auth:(0,n.xI)(e),firestore:(0,s.aU)(e)}}},7481:(e,t,r)=>{r.d(t,{dj:()=>p});var a=r(2115);let i=0,n=new Map,s=e=>{if(n.has(e))return;let t=setTimeout(()=>{n.delete(e),d({type:"REMOVE_TOAST",toastId:e})},5e3);n.set(e,t)},o=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,3)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:r}=t;return r?s(r):e.toasts.forEach(e=>{s(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===r||void 0===r?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},u=[],l={toasts:[]};function d(e){l=o(l,e),u.forEach(e=>{e(l)})}function c(e){let{...t}=e,r=(i=(i+1)%Number.MAX_SAFE_INTEGER).toString(),a=()=>d({type:"DISMISS_TOAST",toastId:r});return d({type:"ADD_TOAST",toast:{...t,id:r,open:!0,onOpenChange:e=>{e||a()}}}),setTimeout(()=>{a()},5e3),{id:r,dismiss:a,update:e=>d({type:"UPDATE_TOAST",toast:{...e,id:r}})}}function p(){let[e,t]=a.useState(l);return a.useEffect(()=>(u.push(t),()=>{let e=u.indexOf(t);e>-1&&u.splice(e,1)}),[e]),{...e,toast:c,dismiss:e=>d({type:"DISMISS_TOAST",toastId:e})}}},9434:(e,t,r)=>{r.d(t,{cn:()=>n});var a=r(2596),i=r(9688);function n(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,i.QP)((0,a.$)(t))}}}]);